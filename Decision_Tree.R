install.packages("rpart")
install.packages("rpart.plot")
library(rpart)
library(rpart.plot)
View(data_set)
data_set$Churn<-as.factor(data_set$Churn)
str(data_set)
data_set_preprocess<-ifels(data_set$Churn=="Yes",1,0)
data_set_preprocess<-ifelse(data_set$Churn=="Yes",1,0)
data_set_preprocess
View(data_set_preprocess)
data_set_preprocess<-data_set
data_set_preprocess$Churn<-ifelse(data_set$Churn=="Yes",1,0)
data_set_preprocess<-subset(data_set_preprocess,select=-customerID)
split<-sample.split(data_set_preprocess,SplitRatio = 0.75)
View(train)
View(train)
train<-subset(data_set_preprocess,split=="TRUE")
test<-subset(data_set_preprocess,split=="FALSE")
View(train)
model_tree<-rpart(Chrun~.,data=train,method="class")
model_tree<-rpart(Churn~.,data=train,method="class")
rpart.plot(model_tree)
test$Churn_predict_tree<-predict(model_tree,test,type="class")
table<-table(test$Churn,test$Churn_predict_tree)
table
library(caret)
cm_table<-confusionMatrix(table)
cm_table
View(test)
summary(model_tree)
printcp(model_tree)
rpart.plot(model_tree)
